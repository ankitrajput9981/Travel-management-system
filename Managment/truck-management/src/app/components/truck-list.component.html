<div class="list-container">
  <h2>Truck Data Management</h2>
  
  <div class="filters-section">
    <div class="filter-row">
      <div class="filter-group">
        <label for="truckSelect">Select Truck:</label>
        <select 
          id="truckSelect" 
          [(ngModel)]="selectedTruckNumber" 
          (change)="onTruckNumberChange()"
          class="truck-select"
        >
          <option value="">All Trucks</option>
          <option *ngFor="let truckNumber of truckNumbers" [value]="truckNumber">
            {{ truckNumber }}
          </option>
        </select>
      </div>

      <div class="filter-group">
        <label for="searchInput">Search:</label>
        <input 
          type="text" 
          id="searchInput" 
          [(ngModel)]="searchTerm" 
          (input)="onSearchChange()"
          placeholder="Search by truck number, driver name, or date"
          class="search-input"
        >
      </div>

      <button (click)="clearFilters()" class="clear-btn">Clear Filters</button>
    </div>
  </div>

  <!-- Truck Summary -->
  <div *ngIf="showSummary && truckSummary" class="summary-card">
    <h3>Truck Summary: {{ truckSummary.truckNumber }}</h3>
    <div class="summary-grid">
      <div class="summary-item">
        <span class="label">Total Trips:</span>
        <span class="value">{{ truckSummary.totalTrips }}</span>
      </div>
      <div class="summary-item">
        <span class="label">Total Kilometers:</span>
        <span class="value">{{ truckSummary.totalKilometers | number:'1.0-0' }}</span>
      </div>
      <div class="summary-item">
        <span class="label">Total Revenue:</span>
        <span class="value revenue">{{ formatCurrency(truckSummary.totalRevenue) }}</span>
      </div>
      <div class="summary-item">
        <span class="label">Total Cost:</span>
        <span class="value cost">{{ formatCurrency(truckSummary.totalCost) }}</span>
      </div>
      <div class="summary-item">
        <span class="label">Total Profit:</span>
        <span class="value" [class]="truckSummary.totalProfit >= 0 ? 'profit' : 'loss'">
          {{ formatCurrency(truckSummary.totalProfit) }}
        </span>
      </div>
      <div class="summary-item">
        <span class="label">Avg Profit/KM:</span>
        <span class="value" [class]="truckSummary.averageProfitPerKm >= 0 ? 'profit' : 'loss'">
          {{ formatCurrency(truckSummary.averageProfitPerKm) }}
        </span>
      </div>
    </div>
  </div>

  <!-- Trucks Table -->
  <div class="table-container">
    <div *ngIf="filteredTrucks.length === 0" class="no-data">
      <p>No truck data found. Add some truck trips to get started!</p>
    </div>

    <table *ngIf="filteredTrucks.length > 0" class="trucks-table">
                        <thead>
                            <tr>
                                <th>Truck #</th>
                                <th>Driver</th>
                                <th>Branch</th>
                                <th>Date</th>
                                <th>Location</th>
                                <th>KM</th>
                                <th>Fuel Cost</th>
                                <th>Other Expenses</th>
                                <th>Total Cost</th>
                                <th>Revenue</th>
                                <th>Profit/Loss</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
      <tbody>
        <tr *ngFor="let truck of filteredTrucks">
          <td class="truck-number">{{ truck.truckNumber }}</td>
          <td>{{ truck.driverName }}</td>
          <td>{{ truck.branch }}</td>
          <td>{{ formatDate(truck.date) }}</td>
          <td>{{ truck.location }}</td>
          <td>{{ truck.kilometers | number:'1.0-0' }}</td>
          <td>{{ formatCurrency(truck.fuelCost) }}</td>
          <td>{{ formatCurrency(truck.otherExpenses) }}</td>
          <td class="cost">{{ formatCurrency(truck.totalCost) }}</td>
          <td class="revenue">{{ formatCurrency(truck.totalRevenue) }}</td>
          <td [class]="truck.profit >= 0 ? 'profit' : 'loss'">
            {{ formatCurrency(truck.profit) }}
          </td>
          <td>
            <button 
              (click)="deleteTruck(truck.id)" 
              class="delete-btn"
              title="Delete this record"
            >
              üóëÔ∏è
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Overall Statistics -->
  <div *ngIf="filteredTrucks.length > 0" class="overall-stats">
    <h3>Overall Statistics</h3>
    <div class="stats-grid">
      <div class="stat-item">
        <span class="stat-label">Total Records:</span>
        <span class="stat-value">{{ filteredTrucks.length }}</span>
      </div>
      <div class="stat-item">
        <span class="stat-label">Total KM:</span>
        <span class="stat-value">{{ filteredTrucks.reduce((sum, t) => sum + t.kilometers, 0) | number:'1.0-0' }}</span>
      </div>
      <div class="stat-item">
        <span class="stat-label">Total Revenue:</span>
        <span class="stat-value revenue">{{ formatCurrency(filteredTrucks.reduce((sum, t) => sum + t.totalRevenue, 0)) }}</span>
      </div>
      <div class="stat-item">
        <span class="stat-label">Total Cost:</span>
        <span class="stat-value cost">{{ formatCurrency(filteredTrucks.reduce((sum, t) => sum + t.totalCost, 0)) }}</span>
      </div>
      <div class="stat-item">
        <span class="stat-label">Total Profit:</span>
        <span class="stat-value" [class]="filteredTrucks.reduce((sum, t) => sum + t.profit, 0) >= 0 ? 'profit' : 'loss'">
          {{ formatCurrency(filteredTrucks.reduce((sum, t) => sum + t.profit, 0)) }}
        </span>
      </div>
    </div>
  </div>
</div>
